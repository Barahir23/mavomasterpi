{% load static %}
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}MavoMaster{% endblock %}</title>
  <script src="{% static 'js/layout_header.js' %}"></script>
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  {% block extra_css %}{% endblock %}
</head>
<body class="theme-dark">
  <!-- Hidden form forces CSRF cookie to be set on initial render -->
  <form id="csrf-seed" style="display:none;">{% csrf_token %}</form>

  <aside id="app-sidebar" aria-label="Hauptnavigation">
    <div class="sidebar-header">
      <button id="sidebar-toggle" aria-expanded="true" title="Seitenleiste ein/ausklappen">
        <span class="icon open">{% include "icons/chevron-left.svg" %}</span>
        <span class="icon closed">{% include "icons/chevron-right.svg" %}</span>
      </button>
    </div>

    <nav class="sidebar-nav" aria-label="Statische Seiten">
      <a href="/" class="nav-item" title="Home">
        <span class="icon">{% include "icons/home.svg" %}</span><span class="label">Home</span>
      </a>
      <a href="/messung/" class="nav-item" title="Messung">
        <span class="icon">{% include "icons/ruler.svg" %}</span><span class="label">Messung</span>
      </a>
      <a href="/projekte/" class="nav-item" title="Projekte">
        <span class="icon">{% include "icons/folder.svg" %}</span><span class="label">Projekte</span>
      </a>
      <a href="/exporte/" class="nav-item" title="Exporte">
        <span class="icon">{% include "icons/upload.svg" %}</span><span class="label">Exporte</span>
      </a>
    </nav>

    <div class="sidebar-context">
      {% block sidebar_context %}{% endblock %}
    </div>

    <div class="sidebar-footer">
      <!-- System button opens flyout -->
      <button class="footer-btn" id="action-system" title="System & Aktionen">
        <span class="icon">{% include "icons/cog-6-tooth.svg" %}</span>
      </button>
    </div>
  </aside>

  <main id="main-content">
    {% block content %}{% endblock %}
  </main>

  <!-- System flyout (opens right of sidebar) -->
  <div id="sys-flyout" class="flyout" aria-hidden="true">
    <div class="flyout__backdrop" id="sys-flyout-backdrop"></div>
    <div class="flyout__panel">
      <ul class="flyout__list">
        <li class="flyout__item" id="sys-act-settings">
          <span class="icon">{% include "icons/cog-6-tooth.svg" %}</span><span class="label">Einstellungen</span>
        </li>
        <li class="flyout__separator" role="separator"></li>
        <li class="flyout__item" id="sys-act-reboot">
          <span class="icon">{% include "icons/arrow-path.svg" %}</span><span class="label">Neu starten</span>
        </li>
        <li class="flyout__item" id="sys-act-shutdown">
          <span class="icon">{% include "icons/power.svg" %}</span><span class="label">Herunterfahren</span>
        </li>
      </ul>
    </div>
  </div>

  <!-- Modal -->
  <div id="mm-modal" class="mm-modal" aria-hidden="true">
    <div class="mm-modal__backdrop" data-mm-close></div>
    <div class="mm-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="mm-modal-title">
      <h3 id="mm-modal-title" class="mm-modal__title">Bestätigen</h3>
      <p id="mm-modal-text" class="mm-modal__text">Aktion ausführen?</p>
      <div id="mm-modal-countdown" class="mm-modal__countdown" style="display:none;"></div>
      <div class="mm-modal__actions">
        <button type="button" class="mm-btn mm-btn--ghost" data-mm-close>Abbrechen</button>
        <button type="button" class="mm-btn mm-btn--primary" id="mm-modal-confirm">OK</button>
      </div>
    </div>
  </div>

  <script src="{% static 'js/layout_footer.js' %}"></script>
  {% block extra_js %}{% endblock %}
</body>
</html>
